winzou_state_machine:
  sylius_order_checkout:
    transitions:
      complete:
        from: [ cart, addressed, shipping_selected, shipping_skipped, payment_selected, payment_skipped ]
        to: completed
    callbacks:
      after:
        sylius_mollie_plugin_payment_surcharge:
          on: ["select_payment"]
          do: ["@sylius_mollie.processor.payment_surcharge", "process"]
          args: ["object"]
  sylius_shipment:
    transitions:
      create_and_ship:
        from: [cart]
        to: shipped
    callbacks:
      before:
        mollie_purify_empty_ready_shipments:
          on: ["ship", "create_and_ship"]
          do: ["@sylius_mollie.partial_ship.purifier.order_shipment", "purify"]
          args: ["object.getOrder()"]
      after:
        sylius_resolve_state:
          on: ["ship", "create_and_ship"]
          do: ["@sylius.state_resolver.order_shipping", "resolve"]
          args: ["object.getOrder()"]
